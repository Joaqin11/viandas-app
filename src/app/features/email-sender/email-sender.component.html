<div class="email-sender-container">
  <h2>Enviar Correo de Aviso</h2>

  <form [formGroup]="emailForm" (ngSubmit)="onSubmit()">
    <div *ngIf="successMessage" class="success-message">
      {{ successMessage }}
    </div>
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <div class="form-group">
      <label for="subject">Asunto:</label>
      <input type="text" id="subject" formControlName="subject" class="form-control" [class.is-invalid]="emailForm?.get('subject')?.invalid && emailForm?.get('subject')?.touched">
      <div *ngIf="emailForm?.get('subject')?.invalid && emailForm?.get('subject')?.touched" class="invalid-feedback">
        El asunto es obligatorio.
      </div>
    </div>

    <div class="form-group">
      <label for="body">Cuerpo del Mensaje:</label>
      <textarea id="body" formControlName="body" rows="5" class="form-control" [class.is-invalid]="emailForm?.get('body')?.invalid && emailForm?.get('body')?.touched"></textarea>
      <div *ngIf="emailForm?.get('body')?.invalid && emailForm?.get('body')?.touched" class="invalid-feedback">
        El cuerpo del mensaje es obligatorio.
      </div>
    </div>
    
    <div class="form-group checkbox-group">
        <input type="checkbox" id="sendToAllUsers" formControlName="sendToAllUsers">
        <label for="sendToAllUsers">Enviar a todos los usuarios</label>
    </div>

    <div class="form-group" *ngIf="!emailForm?.get('sendToAllUsers')?.value">
        <label for="toEmails">Destinatarios (separar por comas):</label>
        <textarea id="toEmails" formControlName="toEmails" rows="3" class="form-control" placeholder="ejemplo1@mail.com, ejemplo2@mail.com"></textarea>
    </div>

    <button type="submit" class="send-button" [disabled]="loading || emailForm?.invalid">
      <span *ngIf="!loading">Enviar Correo</span>
      <span *ngIf="loading">Enviando...</span>
    </button>
  </form>
</div>